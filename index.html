<!DOCTYPE html>
<html>
<body>

<h1>{{.Title}}</h1>

<div id="googleMap" style="width:100%;height:800px;"></div>

<script>
function myMap() {
var mapProp= {
    center:new google.maps.LatLng(51.508742,-0.120850),
    zoom:5,
};
var map=new google.maps.Map(document.getElementById("googleMap"),mapProp);

var infowindow = new google.maps.InfoWindow();

{{range $key, $value := .Planes}}

var test = {lat: {{$value.Lat}}, lng: {{$value.Long}}};
var marker = new google.maps.Marker({position: test, icon: {
      path: google.maps.SymbolPath.FORWARD_OPEN_ARROW,
      scale: 5,
      rotation: {{$value.TrueTrack}}
    }, map: map});


var callsign = {{$value.Callsign}} 
var icao24 = {{$value.Icao24}}
var airport = {{$value.DepartureAirport}}
var time = {{$value.DepartureTime}}

var content = icao24 + '<br>' + callsign + '<br>'+ airport + '<br>'+ time

google.maps.event.addListener(marker, 'click', (function(marker, content, infowindow) {
  return function(){
  infowindow.setContent(content);
  infowindow.open(map,marker);
  }
  })(marker, content, infowindow));

{{end}}

}
</script>

<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB_hmUd2JkX-GVnVPaL4EEll3_iVgX5g_Q&callback=myMap"></script>

</body>
</html>